<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.16">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Stryker Mutator RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Stryker Mutator Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-104444094-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="Stryker Mutator" href="/opensearch.xml"><title data-rh="true">Announcing Stryker 4.0 - Mutation Switching | Stryker Mutator</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://stryker-mutator.io/images/strykerman.png"><meta data-rh="true" name="twitter:image" content="https://stryker-mutator.io/images/strykerman.png"><meta data-rh="true" property="og:url" content="https://stryker-mutator.io/blog/announcing-stryker-4-mutation-switching"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="keywords" content="mutation testing, JavaScript, TypeScript, C#, .NET, Scala, testing, testing tools, software"><meta data-rh="true" property="og:title" content="Announcing Stryker 4.0 - Mutation Switching | Stryker Mutator"><meta data-rh="true" name="description" content="We&#x27;re proud to announce the next major release of the Stryker mutation testing framework for JavaScript and friends: Stryker 4.0."><meta data-rh="true" property="og:description" content="We&#x27;re proud to announce the next major release of the Stryker mutation testing framework for JavaScript and friends: Stryker 4.0."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2020-10-07T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/nicojs"><meta data-rh="true" property="article:tag" content="stryker"><link data-rh="true" rel="icon" href="/images/stryker.svg"><link data-rh="true" rel="canonical" href="https://stryker-mutator.io/blog/announcing-stryker-4-mutation-switching"><link data-rh="true" rel="alternate" href="https://stryker-mutator.io/blog/announcing-stryker-4-mutation-switching" hreflang="en"><link data-rh="true" rel="alternate" href="https://stryker-mutator.io/blog/announcing-stryker-4-mutation-switching" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://QF3A1J09N2-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.94e42893.css">
<link rel="preload" href="/assets/js/runtime~main.97b1c169.js" as="script">
<link rel="preload" href="/assets/js/main.704c38f0.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><div class="announcementBar_IbjG" style="background-color:var(--ifm-navbar-background-color, #fff);color:var(--ifm-navbar-link-color, #000)" role="banner"><div class="announcementBarPlaceholder_NC_W"></div><div class="announcementBarContent_KsVm">ğŸ“½ï¸ <a target="_blank" rel="noopener noreferrer" href="https://www.youtube.com/watch?v=Vq9eqZzblfg">Watch the talk "Who is testing your tests?" from <i>Scala Love in the City</i></a></div><button type="button" class="clean-btn close announcementBarClose_FG1z" aria-label="Close"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/images/stryker.svg" alt="Stryker Mutator Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/images/stryker.svg" alt="Stryker Mutator Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Stryker Mutator</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/stryker-js/introduction">For JavaScript</a><a class="navbar__item navbar__link" href="/docs/stryker-net/introduction">For C#</a><a class="navbar__item navbar__link" href="/docs/stryker4s/getting-started">For Scala</a><a class="navbar__item navbar__link" href="/docs/General/example">An example</a></div><div class="navbar__items navbar__items--right"><a href="https://dashboard.stryker-mutator.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Dashboard<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link header-github-link" target="_self" aria-label="GitHub repository dropdown"></a><ul class="dropdown__menu"><li><a href="https://github.com/stryker-mutator/stryker-js" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>StrykerJS (JS &amp; TS)<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://github.com/stryker-mutator/stryker-net" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Stryker.NET (C#)<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://github.com/stryker-mutator/stryker4s" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Stryker4s (Scala)<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://github.com/stryker-mutator/mutation-testing-elements" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Mutation Testing Elements<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://github.com/stryker-mutator/stryker-mutator.github.io" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>This website<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">ğŸŒœ</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">ğŸŒ</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode (currently light mode)"></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_a9qW thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_uKok margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Kvuv"><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/2021-30-10-announcing-stryker-net-1.md">Announcing Stryker.NET 1.0</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/stryker4s-40-minutes-to-40-seconds">Stryker4s: from 40 minutes to 40 seconds</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/announcing-stryker-js-5-brave-new-dimension.md">Announcing StrykerJS 5.0 - Brave new Dimension</a></li><li class="sidebarItem_CF0Q"><a aria-current="page" class="sidebarItemLink_miNk sidebarItemLinkActive_RRTD" href="/blog/announcing-stryker-4-mutation-switching">Announcing Stryker 4.0 - Mutation Switching</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/announcing-stryker-4-beta-mutation-switching">Announcing Stryker 4.0 Beta</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_rzP5" itemprop="headline">Announcing Stryker 4.0 - Mutation Switching</h1><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2020-10-07T00:00:00.000Z" itemprop="datePublished">October 7, 2020</time> Â· <!-- -->11 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><a href="https://github.com/nicojs" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_o0gy" src="https://avatars3.githubusercontent.com/u/1828233?s=400&amp;u=fec18ad3776aaafec54c49bbd7173a841ae7ea59&amp;v=4" alt="Nico Jansen"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/nicojs" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Nico Jansen</span></a></div><small class="avatar__subtitle" itemprop="description">Stryker Team</small></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><p>We&#x27;re proud to announce the next major release of the Stryker mutation testing framework for JavaScript and friends: Stryker 4.0.</p><p>This release marks a fundamental shift in the way Stryker works internally. It now uses &quot;mutation switching&quot;, which improves performance and usability, similar to how Stryker.NET and Stryker4s already work. This change, unfortunately, couldn&#x27;t be done without breaking changes. See the breaking changes paragraph if you&#x27;re interested.</p><p><strong>ğŸ§ Listen to the <a href="https://thedeepdive.simplecast.com/episodes/mutation-testing-with-stryker" target="_blank" rel="noopener noreferrer">&quot;Mutation testing with Stryker&quot; podcast episode on InDepth.dev</a></strong></p><p>If you&#x27;re new to mutation testing, it&#x27;s a way to measure your tests&#x27; effectiveness. Please look at <a href="https://stryker-mutator.io/example" target="_blank" rel="noopener noreferrer">our RoboBar ğŸ¤–ğŸ· example</a> and see how even 100% code coverage doesn&#x27;t tell the whole story. Mutation testing is the only way to make sure you&#x27;re not missing any tests.</p><p><strong><em>Note: updated on 9 October 2020: add remark about TypeScript 3.7 requirement in <a href="#breaking-changes">Breaking changes</a>.</em></strong></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="-getting-started">ğŸš€ Getting started<a class="hash-link" href="#-getting-started" title="Direct link to heading">â€‹</a></h2><p>If you&#x27;re new to Stryker, please follow the <a href="/stryker/quickstart">quickstart guide</a>.</p><p>If you&#x27;re already using Stryker, you can install this latest version with your package manager of choice.</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> --save-dev @stryker-mutator/core</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Don&#x27;t forget to do the same for your Stryker plugins. Please note that the following plugins have been removed and are no longer needed:</p><ul><li><del>@stryker-mutator/typescript</del></li><li><del>@stryker-mutator/jasmine-framework</del></li><li><del>@stryker-mutator/mocha-framework</del></li><li><del>@stryker-mutator/babel-transpiler</del></li><li><del>@stryker-mutator/webpack-transpiler</del></li><li><del>@stryker-mutator/javascript-mutator</del></li></ul><p>You can remove these from your package.json.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="-mutation-switching">ğŸ‘½ Mutation switching<a class="hash-link" href="#-mutation-switching" title="Direct link to heading">â€‹</a></h2><p>Mutation switching is a way to put all mutants into your code simultaneously.</p><p>Let&#x27;s take a look at an example.</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx js"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">a</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> a </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>When you feed this code to Stryker, it will generate two mutants:</p><p><code>ğŸ‘½ function add(a, b) { return a - b }</code><br>
<code>ğŸ‘¾ function add(a, b) {}</code></p><p>Previous versions of Stryker would make two copies of your source code. One for each mutant. Stryker 4.0 will now place <em>all mutants into the code simultaneously</em>, but with only <em>one mutant active at any one time</em>.</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx js"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">a</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">global</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">activeMutant</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ğŸ‘¾</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> global</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">activeMutant</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> a </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> b </span><span class="token comment" style="color:#999988;font-style:italic">// ğŸ‘½</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> a </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>(simplified example)</p><p>Stryker now runs your tests while changing (or <em>switching</em>) the active mutant between runs. Mutation switching can improve performance dramatically, depending on the type of project.</p><p>You&#x27;re probably wondering: how much performance improvement? Like all great questions, the answer is: &#x27;it depends&#x27;. For example, when you bundle your code with webpack before running the tests, then webpack only needs to run once, a significant performance gain. On the other hand, if you&#x27;re running Stryker on an ES5 project with mocha, the improvement might not be that substantial. In our experience, you can expect somewhere between 20% to 70% speed increase.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="-code-instrumentation">ğŸ  Code instrumentation<a class="hash-link" href="#-code-instrumentation" title="Direct link to heading">â€‹</a></h2><p>Mutation Switching yields a significant performance improvement, but it means that Stryker is required to perform some complex transformations to the <a href="https://en.wikipedia.org/wiki/Abstract_syntax_tree" target="_blank" rel="noopener noreferrer">Abstract Syntax Tree (AST)</a>.</p><p>Doing this <em>instrumentation</em> means visiting each node of the AST to collect and place mutants. This instrumentation is implemented with the <a href="https://babeljs.io/" target="_blank" rel="noopener noreferrer">Babel</a> parser and now ships with <code>@stryker-mutator/core</code>. We&#x27;re taking advantage of Babel&#x27;s support for all types of JavaScript, including TypeScript code.</p><p><em>Note that to implement mutation switching in both TypeScript and JavaScript before the release of Babel v7 would have meant implementing it twice. We think it is incredible that the Babel maintainers chose to add TypeScript support. We&#x27;re standing on the shoulders of giants here ğŸ‰. Without this, we probably wouldn&#x27;t have done it.</em></p><p>This instrumentation means you <em>no longer need to configure the mutator</em> in your Stryker configuration. Stryker will always use the new mutation instrumenter. It supports TypeScript, JavaScript, Flow, and JSX. It even mutates script tags in <code>.html</code> or <code>.vue</code> files. It also picks up your babel configuration out-of-the-box, so no custom configuration is neededâ€”cupcakes for everyone ğŸ§.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="-build-command-support">ğŸ‘·â€â€ Build command support<a class="hash-link" href="#-build-command-support" title="Direct link to heading">â€‹</a></h2><p><em>Note: not all projects need building. Simple projects might deploy JS code as is, or the test runner might take care of this step for you. For example, running your tests with ts-node or babel/register or running it with Jest or Karma with the webpack plugin.</em></p><p>Previous versions of Stryker allowed you to configure a transpiler. For example, configuring <code>&quot;transpilers&quot;: [&quot;babel&quot;]</code> would allow all files to be transpiled with the <code>@stryker-mutator/babel-transpiler</code> plugin. This way of working had its disadvantages:</p><ul><li>â›” Since every mutant needed to transpiled one by one, it was slow.</li><li>â›” Every transpiler/bundler required a plugin. We only officially supported Webpack, Babel, and TypeScript. If you were using a different tool, you were out of luck.</li><li>â›” It was hard to maintain the transpiler plugins since it hooked into the transpiler/bundler&#x27;s API.</li></ul><p>Stryker 4.0 gets rid of the transpiler plugins. Instead, it allows you to configure a <code>buildCommand</code>. Stryker will run this command once in the sandbox directory after instrumenting your code and just before starting the dry run. For example, running Stryker with <code>--buildCommand &quot;npm run build&quot;</code> will run <code>npm run build</code> inside the sandbox directory.</p><p>This new way of working gets rid of all the disadvantages listed above. It will only run once, you can use whichever tool you want, and we don&#x27;t have to maintain pluginsâ€”a win-win-win scenario. The old transpiler plugins are no longer needed, and you can remove them from your project.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="-checker-plugin">âœ… Checker plugin<a class="hash-link" href="#-checker-plugin" title="Direct link to heading">â€‹</a></h2><p>You might know that the old <code>@stryker-mutator/typescript</code> transpiler not only transpiled your code but also filtered out mutants that resulted in type errors, marking them with &quot;compile error&quot; in your report. Mutants with this status are considered invalid and do not influence your mutation score.</p><p>Stryker 4.0 removes the transpiler plugin in favor of <code>--buildCommand</code>.</p><p><em>Wondering how your TypeScript code compiles even while some mutants might create type errors? Stryker places <code>// @ts-nocheck</code> atop your code files. Your TypeScript compiler will ignore any type errors produced by instrumenting your code.</em></p><p>However, you might still want to invalidate mutants that result in a type error, so you won&#x27;t spend any time looking at them. The new &quot;Checker&quot; plugin helps you here. Checker plugins can choose to invalidate mutants based on rules specific to the checker.</p><p>We maintain one such checker, the <code>@stryker-mutator/typescript-checker</code>. It will mark mutants that would result in a type error with &quot;Compile error&quot;.</p><p>Install it with <code>npm install -D @stryker-mutator/typescript-checker</code>.</p><p>Configure it with:</p><div class="codeBlockContainer_I0IT language-json theme-code-block"><div class="codeBlockContent_wNvx json"><pre tabindex="0" class="prism-code language-json codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;checkers&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;typescript&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;tsconfigFile&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;tsconfig.json&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Please see <a href="https://github.com/stryker-mutator/stryker-js/tree/master/packages/typescript-checker#readme" target="_blank" rel="noopener noreferrer">the TypeScript checker&#x27;s readme</a> for more details.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="-coverage-analysis">â˜” Coverage analysis<a class="hash-link" href="#-coverage-analysis" title="Direct link to heading">â€‹</a></h2><p>Coverage analysis is a great way to speed up mutation testing. It is a means to reduce the number of tests Stryker needs to run to test a mutant. Stryker has three flavors:</p><ul><li><strong>&quot;off&quot;</strong>: No coverage analysis</li><li><strong>&quot;all&quot;</strong>: Mutant coverage for the entire test suite is measured. Mutants without coverage are marked with &quot;no coverage&quot;. But all tests run for mutants that are covered.</li><li><strong>&quot;perTest&quot;</strong>: Mutant coverage is measured per test. Stryker runs only the tests that cover a specific mutant when it tests that mutant.</li></ul><p>Running with &quot;perTest&quot; coverage analysis allows for significant performance improvement, usually between 40% and 60%. However, most projects were unable to take advantage of it because Stryker relied on <a href="https://istanbul.js.org/" target="_blank" rel="noopener noreferrer">istanbul code coverage</a> combined with test runner hooks. It only worked in scenarios without transpiling or bundling.</p><p>This changes with version 4. When Stryker instruments your code with mutants, it also injects the coverage instrumentation. No need for instanbul anymore, allowing Stryker to measure mutant coverage, <em>regardless of which bundler/transpiler you are using</em>. Hooking into the test runner is the only remaining requirement. All test runner plugins support these hooks, except for the <code>@stryker-mutator/jest-runner</code> (although we&#x27;re <a href="https://github.com/stryker-mutator/stryker-js/issues/2316" target="_blank" rel="noopener noreferrer">planning to support it</a>).</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="-other-changes">ğŸ§¹ Other changes<a class="hash-link" href="#-other-changes" title="Direct link to heading">â€‹</a></h2><p>We also decided to take this opportunity to improve the maintainability of the Stryker code further. That&#x27;s why we&#x27;ve decided to drop support for two more plugin types.</p><p><strong>The <code>TestFramework</code> plugins are removed.</strong></p><p>A test framework plugin used to be responsible for allowing Stryker to hook into the test framework to support &quot;perTest&quot; coverage analysis. In practice, this was often tightly coupled to the test runner itself. For example, the mocha test runner uses -you guessed it- the mocha test framework. It made configuring Stryker needlessly complicated. That&#x27;s why we&#x27;ve decided to drop this plugin type and make the Test Runner plugin responsible for hooking into the test framework directly. As a result, the following dependencies are no longer needed: <code>@stryker-mutator/mocha-framework</code> and <code>@stryker-mutator/jasmine-framework</code>.</p><p><strong>The <code>OptionsEditor</code> plugins are removed.</strong></p><p>Options editors provided a way for plugins to edit the Stryker options directly. In practice, this was used to load plugin-specific options and attach them to the StrykerOptions object for later use. Plugins should now load their needed options in their life cycle, for example, in the <code>init</code> method of the plugin.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="-breaking-changes">ğŸ’¥ Breaking changes<a class="hash-link" href="#-breaking-changes" title="Direct link to heading">â€‹</a></h2><p>Here is a list of the most important breaking changes. For a full list, please see our <a href="https://github.com/stryker-mutator/stryker-js/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer">changelog</a>.</p><ul><li>Configuring &quot;transpilers&quot; is no longer supported; please use <code>--buildCommand</code> instead.</li><li>Configuring <code>mutator</code> as a string, or configuring <code>mutator.name</code> is no longer supported, Stryker will always use its code instrumenter.</li><li>TypeScript 3.7 or higher is required if you&#x27;re using TypeScript to transpile your code, either via a <code>--buildCommand</code> or via a test runner plugin, like <a href="https://www.npmjs.com/package/ts-jest" target="_blank" rel="noopener noreferrer">ts-jest</a>, <a href="https://www.npmjs.com/package/karma-webpack" target="_blank" rel="noopener noreferrer">karma-webpack</a> or using the <a href="https://www.npmjs.com/package/@angular/cli" target="_blank" rel="noopener noreferrer">angular-cli</a>. If you&#x27;re dependent on TS &lt;3.7, please consider upgrading, or keep using Stryker V3. This is because the mutation instrumenter heavily leans on the support of <code>// @ts-nocheck</code> feature, added in TS3.7. If you&#x27;re using another transpiler, like <a href="https://babeljs.io" target="_blank" rel="noopener noreferrer">babel</a> or <a href="https://github.com/TypeStrong/ts-node" target="_blank" rel="noopener noreferrer">ts-node with <code>transpileOnly</code></a>, then Stryker will work fine.</li><li>Because of the requirement for TS 3.7, Angular &gt;=9.0 is required for Angular projects.</li><li>The <code>&quot;command&quot;</code> test runner is now &quot;best-effort&quot;. Stryker will use an environment variable to communicate which mutant should be active. Your test command should pass the environment variables to the test environment. We expect this to work for most test runners and test commands out there. One exception is Karma, but since we have the <code>@stryker-mutator/karma-runner</code> for this use case, it shouldn&#x27;t be a problem.</li><li>Support for the Web Component Tester is dropped. Please see <a href="https://github.com/stryker-mutator/stryker-js/issues/2386" target="_blank" rel="noopener noreferrer">#2386</a> for reasoning.</li><li>Exporting a <code>function</code> from your &quot;stryker.conf.js&quot; file is deprecated. Please export your config as an object instead, or use a stryker.conf.json file. Please see <a href="https://github.com/stryker-mutator/stryker-js/issues/2429" target="_blank" rel="noopener noreferrer">#2429</a> for more details.</li><li>The <code>--maxConcurrentTestRunner</code> option is now deprecated, please use <code>--concurrency</code> instead. Stryker will use this setting to determine how to scale checkers or test runner processes. Note that Stryker will no longer prevent you from configuring more than the number of logical cores in your machine, i.e., <code>--concurrency 9999</code> might be a bad idea.</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="-whats-next">ğŸ”® What&#x27;s next?<a class="hash-link" href="#-whats-next" title="Direct link to heading">â€‹</a></h2><p>Mutation switching was a considerable undertaking, but we had to do it since it allows for further performance and usability improvements. Let&#x27;s discuss some here.</p><p>All these issues align with our project goals, which we&#x27;ve published in <a href="https://github.com/stryker-mutator/stryker-js/wiki/Roadmap" target="_blank" rel="noopener noreferrer">our roadmap</a>.</p><p><strong>Better Jest support</strong></p><p>With mutation switching in our backpack, implementing &quot;perTest&quot; coverage analysis for Jest is now on the table, allowing Stryker to run fewer tests in total. See <a href="https://github.com/stryker-mutator/stryker-js/issues/2316" target="_blank" rel="noopener noreferrer">#2316</a> for more info.</p><p><strong>Hot reload</strong></p><p>Currently, Stryker will reload all code files between test runs (clearing them from the <a href="https://nodejs.org/api/modules.html#modules_require_cache" target="_blank" rel="noopener noreferrer">require.cache</a> or doing a full page reload with Karma). However, thanks to mutation switching, the mutated code does not have to be reloaded. Instead, we can switch the active mutant and do another test run. Mocha will be the first test runner to receive this improvement. See <a href="https://github.com/stryker-mutator/stryker-js/issues/2413" target="_blank" rel="noopener noreferrer">#2413</a> for more info.</p><p><strong>In place mutation</strong></p><p>Stryker currently never mutates <em>your code</em> directly. Instead, it makes a copy of it in a &quot;sandbox&quot; directory, and it mutates your code there. The reason for this should be apparent; you don&#x27;t want mutants to make there way into production.</p><p>However, in some corner cases, the simple act of copying your code to a sandbox directory makes running the tests impossible. See <a href="https://github.com/stryker-mutator/stryker-js/issues/2163" target="_blank" rel="noopener noreferrer">#2163</a> for some examples. To truly make Stryker work for all JavaScript projects, we will need to allow for &quot;in place&quot; mutation. Don&#x27;t worry, this will be optional, and we will make sure to let you know what Stryker is doing ğŸ§.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="-thank-you">ğŸ‰ Thank you<a class="hash-link" href="#-thank-you" title="Direct link to heading">â€‹</a></h2><p>Back in July, we released the first beta of Stryker 4. Since then, we got loads of responses resulting in the closing of <a href="https://github.com/stryker-mutator/stryker-js/issues?q=is%3Aissue+milestone%3A4.0+is%3Aclosed" target="_blank" rel="noopener noreferrer">more than 40 issues</a>, some of which were pretty major ğŸ˜…. We want to thank everyone who helped to make this release possible! In particular (in no specific order)</p><p>ğŸŒ¹ <a href="https://github.com/gramster" target="_blank" rel="noopener noreferrer">gramster</a><br>
<!-- -->ğŸ’<a href="https://github.com/kmdrGroch" target="_blank" rel="noopener noreferrer">kmdrGroch</a><br>
<!-- -->ğŸŒ¼<a href="https://github.com/Lakitna" target="_blank" rel="noopener noreferrer">Lakitna</a><br>
<!-- -->ğŸŒ»<a href="https://github.com/brodybits" target="_blank" rel="noopener noreferrer">brodybits</a><br>
<!-- -->ğŸŒº<a href="https://github.com/Garethp" target="_blank" rel="noopener noreferrer">Garethp</a></p><p>You guys are incredible!</p><p>If you read through this article: thank you! You&#x27;re awesome! Now stop reading and give Stryker 4 a try. And let us know what you think ğŸ˜€.</p></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_h6_j"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/stryker">stryker</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/stryker-mutator/stryker-mutator.github.io/edit/develop/blog/2020-10-07-announcing-stryker-4-mutation-switching.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/announcing-stryker-js-5-brave-new-dimension.md"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Announcing StrykerJS 5.0 - Brave new Dimension</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/announcing-stryker-4-beta-mutation-switching"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Announcing Stryker 4.0 Beta</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_cNA8 thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#-getting-started" class="table-of-contents__link toc-highlight">ğŸš€ Getting started</a></li><li><a href="#-mutation-switching" class="table-of-contents__link toc-highlight">ğŸ‘½ Mutation switching</a></li><li><a href="#-code-instrumentation" class="table-of-contents__link toc-highlight">ğŸ  Code instrumentation</a></li><li><a href="#-build-command-support" class="table-of-contents__link toc-highlight">ğŸ‘·â€â€ Build command support</a></li><li><a href="#-checker-plugin" class="table-of-contents__link toc-highlight">âœ… Checker plugin</a></li><li><a href="#-coverage-analysis" class="table-of-contents__link toc-highlight">â˜” Coverage analysis</a></li><li><a href="#-other-changes" class="table-of-contents__link toc-highlight">ğŸ§¹ Other changes</a></li><li><a href="#-breaking-changes" class="table-of-contents__link toc-highlight">ğŸ’¥ Breaking changes</a></li><li><a href="#-whats-next" class="table-of-contents__link toc-highlight">ğŸ”® What&#39;s next?</a></li><li><a href="#-thank-you" class="table-of-contents__link toc-highlight">ğŸ‰ Thank you</a></li></ul></div></div></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/General/faq">FAQ</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://join.slack.com/t/stryker-mutator/shared_invite/enQtOTUyMTYyNTg1NDQ0LTU4ODNmZDlmN2I3MmEyMTVhYjZlYmJkOThlNTY3NTM1M2QxYmM5YTM3ODQxYmJjY2YyYzllM2RkMmM1NjNjZjM" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/stryker_mutator" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/stryker-mutator/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://infosupport.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_RC3H"><img src="/images/info-support.svg" alt="Info Support Logo" class="themedImage_W2Cr themedImage--light_TfLj footer__logo"><img src="/images/info-support.svg" alt="Info Support Logo" class="themedImage_W2Cr themedImage--dark_oUvU footer__logo"></a></div><div class="footer__copyright">Powered by <a target="_blank" rel="noopener noreferrer" href="https://www.infosupport.com/open-source/">Info Support</a>.<br>Stryker is released under the Apache 2.0 license. Site by the <a target="_blank" rel="noopener noreferrer" href="https://github.com/orgs/stryker-mutator/people">Stryker team</a>. Logo by Selina van den Top.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.97b1c169.js"></script>
<script src="/assets/js/main.704c38f0.js"></script>
</body>
</html>