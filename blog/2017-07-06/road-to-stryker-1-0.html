<!DOCTYPE html><html><head><meta charset="utf8"><meta http-equiv="X-UA-Compatible" content="chrome=1"><meta name="description" content="Stryker - The JavaScript mutation testing framework: Measure the effectiveness of JavaScript tests."><title>Road to Stryker 1.0 - Stryker - The JavaScript mutation testing framework</title><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32"><link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16"><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#b74934"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="/stylesheets/bootstrap/css/bootstrap.min.css"><link rel="stylesheet" href="/stylesheets/bootstrap/css/bootstrap-theme.min.css"><link rel="stylesheet" href="/stylesheets/stryker.css"><link rel="stylesheet" href="/stylesheets/font-awesome-4.6.3/css/font-awesome.min.css"><link rel="stylesheet" href="/stylesheets/highlightjs/styles/solarized-light.css"></head><body><nav class="navbar navbar-default navbar-fixed-top"><div class="container"><div class="navbar-header"><a class="navbar-brand" href="/"><img src="/images/stryker_205x205.png" alt="Stryker" width="20" height="20"></a><button class="pull-left navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div><div class="collapse navbar-collapse" id="navbar"><ul class="nav navbar-nav"><li><a href="/" title="Home">Home</a></li><li><a href="/quickstart.html" title="Quickstart">Quickstart</a></li><li class="active"><a href="/blog.html" title="Blog">Blog</a></li><li><a href="/plugins.html" title="Plugins">Plugins</a></li><li><a href="/mutators.html" title="Supported mutators">Supported mutators</a></li><li><a href="/faq.html" title="FAQ">FAQ</a></li></ul></div><a href="https://github.com/stryker-mutator/stryker" id="forkme_banner">View me on GitHub</a></div></nav><div class="container"><div class="row"><div class="col-md-12"><h1>Road to Stryker 1.0</h1><p>Published: 6 July 2017</p><p class="lead">Stryker is about two years old. During this time we achieved a lot. But it's far from finished. So, what's next? Let's take a glimpse in the future.</p><p>Some of Strykers achievements are:</p>
<ul>
<li>Stryker is the first functional mutation testing framework for JavaScript.</li>
<li>Stryker is test framework and test runner agnostic.</li>
<li>Stryker boosts performance by running tests in parallel.</li>
<li>Stryker uses advance coverage analysis to do less work.</li>
</ul>
<p>The way Stryker achieves all this, is using a plugin model. Want to use a different test runner?
Create a class that implements the <a href="https://github.com/stryker-mutator/stryker/blob/master/packages/stryker-api/src/test_runner/TestRunner.ts"><code>TestRunner</code> interface</a> and your done.
Stryker only does one assumption: your JavaScript code can be directly loaded into you environment.</p>
<h3>Road to v1</h3>
<p>We're very happy with the results thus far. But we're far from done. The JavaScript world is constantly evolving.
A couple of examples of modern use cases are:</p>
<ul>
<li>A web project written in JSX / <a href="https://facebook.github.io/react/">React</a></li>
<li>A node project written in <a href="http://typescriptlang.org/">TypesScript</a> and executed using <a href="https://www.npmjs.com/package/ts-node">ts-node</a></li>
<li>An Angular project generated with the <a href="https://www.npmjs.com/package/@angular/cli">angular cli</a> using <a href="https://webpack.js.org/">webpack</a> and <a href="https://www.npmjs.com/package/typescript">TypeScript</a></li>
<li>A web project using <a href="https://vuejs.org/">VueJS</a></li>
<li>A web component written in HTML5 using <a href="https://www.polymer-project.org">Polymer</a> and <a href="https://webpack.js.org/">webpack</a></li>
</ul>
<p>In order to stay relevant, these use cases need to be supported in a user friendly way.
Only then are we comfortable with tagging Stryker with a version <em>1</em> tag.</p>
<h3>False assumption</h3>
<p>If you look at the modern use cases, they have something in common:
your code cannot be directly loaded into the JavaScript environment. It's not even JavaScript in some cases.
It first needs to be compiled, transpiled and/or bundled, before it can be executed.
For the sake of this article, let's call this step <a href="https://en.wikipedia.org/wiki/Source-to-source_compiler">transpiling</a>.
This makes the assumption that Stryker does a false one: <strong>it should not assume the code you write is JavaScript</strong>.</p>
<h3>First attempt</h3>
<p>We've had a lot of discussion within the Stryker team on how to support these use cases.
One possibility is to first transpile your code before we run the mutation tests on it.
We can even make is user-friendly by using a plugin model for this.</p>
<p>In the end we decided against this approach, because it comes with a big downside: it will cause a lot of false positives.</p>
<p>To illustrate: let's take this piece of TypeScript code:</p>
<pre><code class="language-typescript">const b = 42;
const a = `the answer is ${b}`;
</code></pre>
<p>This might transpile to:</p>
<pre><code class="language-javascript">var b = 42;
var a = 'the answer is ' + b;
</code></pre>
<p>When mutation testing comes along: it changes <code>'the answer is ' + b</code> to <code>'the answer is ' - b</code>.
This is a valid mutation for JavaScript (if you're curious: the answer is <code>NaN</code>).
However, <code>'the answer is ' - b</code> is <em>not a valid TypeScript expression</em>. It results in the following compile error:</p>
<pre><code class="language-bash">The left-hand side of an arithmetic operation must be of type 'any', 'number' or an enum type.
</code></pre>
<p>This is why we refer to it as a false positive. We falsy identified this mutant. This is why we shouldn't blindly mutate transpiled code.</p>
<h2>Open heart surgery</h2>
<p>The only solution for supporting these use cases, is to move the actual transpiling phase to
Stryker itself. This way, we can make sure only valid mutations are done to your code because
we <em>teach</em> Stryker which mutations are valid and which are invalid.</p>
<p>However, we don't want to just hard code it all in Stryker. This means that the transpiling and mutating of the code will be the responsibility of an new plugin type.
Let's call this the <code>transpiler</code> plugin.</p>
<p>We've sketched the new workflow for the TypeScript use case on a whiteboard:</p>
<p><img src="/images/blogs/transpiler-plugin.jpg" alt="transpiler-plugin"></p>
<p>Let's explain what happens in 2 steps:</p>
<ol>
<li>Initial test run</li>
<li>Mutation testing</li>
</ol>
<h3>Step 1: Initial test run</h3>
<p>Starting from the top left: Stryker starts by reading your Stryker configuration file.
After that, we read in the source files into memory. As you might have noticed, these will be the <em>typescript files</em>.
Next up: it's the new <code>stryker-typescript-transpiler</code> plugin's time to shine. It will transpile the *.ts files into *.js files
and it will use your &quot;tsconfig.json&quot; configuration for this. The JavaScript output of this process will
be written to disk by Stryker in something that we call a <em>Sandbox</em>. In this Sandbox, Stryker can
start the initial test run as usual.</p>
<p>Why this complicated setup? After all, if we want to do an initial test run, we might as well just let your build process transpile the code
and run the tests using your test runner. The answer is that we need a baseline of your tests ran by Stryker.
In the next step, Stryker will write mutations to different Sandboxes and run your tests.
We need a control step to make sure your tests pass under normal circumstances. Also: this is where
we measure your code coverage results for every test (if your test framework and test runner support it), which
are used to speed up mutation testing.</p>
<h3>Step 2: Mutation testing</h3>
<p>After the initial test run completed successfully, we proceed with the actual mutation testing. The first step here
is about figuring out how we can mutate your source code. This is again done by the <code>stryker-typescript-transpiler</code> plugin.
It will mutate the TypeScript specific <a href="https://en.wikipedia.org/wiki/Abstract_syntax_tree">abstract syntax tree</a>, but <em>only
in valid ways</em>. For example: it won't mutate <code>'the answer is ' + 42</code> into <code>'the answer is ' - 42</code>, but it might
mutate it into <code>'Stryker was here' + 42</code>. The output of this process is a list of (in-memory) mutants.</p>
<p>A mutant will have 2 parts: a TypeScript part and a JavaScript part. Stryker itself only cares about the
JavaScript part, because that is the recipe to mutate the JavaScript code in the sandboxes.
This will allow Stryker to do mutation testing without needing to compile the code for each mutant, which would be disastrous for performance.
The TypeScript part of a mutant can be used to report the mutated code to the end user. So the mutants that will be reported
in the exact code and language that the end user uses.</p>
<h2>Plain JavaScript projects</h2>
<p>Back to plain JavaScript projects. What will change for them? The answer is: not much.
We'll basically move the current logic for mutating code to a new <code>stryker-javascript-transpiler</code> plugin.
It will be a pass-through transpiler, meaning that the code you write will be used directly.
Mutating of JavaScript code will move to this plugin as well.</p>
<h2>Want to help?</h2>
<p>Want to help? Great! We're really looking for people interested in helping us reach our goal of supporting all JavaScript based projects!</p>
<p>Want to get in touch? Find us on <a href="https://gitter.im/stryker-mutator/stryker" target="_blank">Gitter</a> or <a href="https://twitter.com/search?q=%23strykermutator&amp;src=typd" target="_blank">Twitter</a>.</p><a href="/blog.html" title="blog">Back to blogs</a></div></div><footer class="navbar navbar-footer"><div class="container"><p class="navbar-text">Stryker is released under the Apache 2.0 license. Site by Nico Jansen, Simon de Lang and Alex van Assem. Logo by Selina van den Top.</p></div></footer><script src="/javascripts/jquery-2.2.4.min.js"></script><script src="/stylesheets/bootstrap/js/bootstrap.min.js"></script><script src="/stylesheets/highlightjs/highlight.pack.js"></script><script src="/javascripts/main.js"></script><script>hljs.initHighlightingOnLoad();</script></div></body></html>